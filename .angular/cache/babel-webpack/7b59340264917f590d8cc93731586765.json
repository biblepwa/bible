{"ast":null,"code":"import * as wasm from '../../../pkg';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../bible.service\";\nimport * as i2 from \"@angular/platform-browser\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"../safe.pipe\";\n\nfunction SearchComponent_option_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 16);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const select_r4 = ctx.$implicit;\n    i0.ɵɵproperty(\"ngValue\", select_r4.id)(\"selected\", select_r4.selected);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(select_r4.label);\n  }\n}\n\nfunction SearchComponent_option_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 16);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const select_r5 = ctx.$implicit;\n    i0.ɵɵproperty(\"ngValue\", select_r5.id)(\"selected\", select_r5.selected);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(select_r5.label);\n  }\n}\n\nfunction SearchComponent_ng_template_23_Template(rf, ctx) {}\n\nexport let SearchComponent = /*#__PURE__*/(() => {\n  class SearchComponent {\n    constructor(bibleService, title, elementRef, router) {\n      this.bibleService = bibleService;\n      this.title = title;\n      this.elementRef = elementRef;\n      this.router = router;\n      this.checkedNumber = 2;\n      this.testaments = [{\n        id: 0,\n        label: \"Old Testament\"\n      }, {\n        id: 1,\n        label: \"New Testament\"\n      }, {\n        id: 2,\n        label: \"Old and New Testaments\",\n        selected: true\n      }];\n      this.accuracy = 0;\n      this.accuracyLevel = [{\n        id: 0,\n        label: \"Contains (faster)\"\n      }, {\n        id: 1,\n        label: \"Exact (slower)\"\n      }]; // change title so as to not make it a button\n\n      this.bibleService.pageTitle = \"Search\";\n      this.bibleService.title = this.bibleService.pageTitle;\n      this.title.setTitle('Bible Search');\n    }\n\n    ngOnInit() {}\n\n    ngAfterViewInit() {\n      window.scroll(0, Number(localStorage.getItem('searchScrollY')));\n    }\n\n    ngAfterViewChecked() {\n      //hack needed to add functionality to innerhtml from Rust/wasm\n      if (!this.elementRef.nativeElement.querySelector(\".eventListenerAdded\")) {\n        //check if this function has already run\n        if (this.elementRef.nativeElement.querySelectorAll(\".listResults\")) {\n          const res = this.elementRef.nativeElement.querySelectorAll(\".listResults\");\n          res.forEach(element => {\n            element.addEventListener(\"click\", () => {\n              element.classList.add(\"eventListenerAdded\"); //add empty class to test against; see above; - this is a terrible hack\n\n              const splits = element.id.toString().split('-');\n              this.bibleService.testament = Number(splits[0]);\n              this.bibleService.bookSelected = Number(splits[1]);\n              this.bibleService.title = this.bibleService.bible[this.bibleService.testament].books[this.bibleService.bookSelected].bookName;\n              this.bibleService.showChapters = false;\n              this.bibleService.displayMenu = false;\n              let frag = (splits[2] + \"-\" + splits[3]).toString();\n              this.router.navigate(['book'], {\n                fragment: frag\n              }); //works\n\n              if (document.getElementById(frag)) {\n                document.getElementById(frag).classList.add(\"active\");\n              }\n            });\n          });\n        }\n      }\n    }\n\n    selectedTest() {\n      this.checkedNumber = +this.checkedNumber;\n    }\n\n    selectedAccuracy() {\n      this.accuracy = +this.accuracy;\n    }\n\n    submitSearch(req) {\n      window.scrollTo(0, 0); // bring new search to top of page\n\n      this.bibleService.searchRequest = req;\n      this.bibleService.searchResults = wasm.search(this.checkedNumber, req, this.accuracy);\n    }\n\n    scrolled() {\n      // keep position in case of return\n      localStorage.setItem('searchScrollY', window.pageYOffset.toString());\n    }\n\n  }\n\n  SearchComponent.ɵfac = function SearchComponent_Factory(t) {\n    return new (t || SearchComponent)(i0.ɵɵdirectiveInject(i1.BibleService), i0.ɵɵdirectiveInject(i2.Title), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i3.Router));\n  };\n\n  SearchComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: SearchComponent,\n    selectors: [[\"app-search\"]],\n    hostBindings: function SearchComponent_HostBindings(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵlistener(\"scroll\", function SearchComponent_scroll_HostBindingHandler() {\n          return ctx.scrolled();\n        }, false, i0.ɵɵresolveWindow);\n      }\n    },\n    decls: 24,\n    vars: 9,\n    consts: [[3, \"click\"], [1, \"searchSelect\"], [1, \"searchFor\"], [\"for\", \"req\", 1, \"searchInputLabel\"], [\"name\", \"req\", \"type\", \"search\", \"required\", \"\", \"minlength\", \"2\", 1, \"searchInput\", 3, \"placeholder\", \"keyup.enter\"], [\"req\", \"\"], [\"type\", \"image\", \"src\", \"./assets/search_neutral.svg\", 1, \"searchButton\", 3, \"click\"], [1, \"searchIn\"], [1, \"space\"], [\"for\", \"testament\"], [\"name\", \"testaments\", \"id\", \"testaments\", 1, \"testaments\", 3, \"ngModel\", \"ngModelChange\"], [3, \"ngValue\", \"selected\", 4, \"ngFor\", \"ngForOf\"], [\"for\", \"accuracy\"], [\"name\", \"accuracy\", \"id\", \"accuracy\", 1, \"accuracy\", 3, \"ngModel\", \"ngModelChange\"], [1, \"searchResults\", 3, \"innerHTML\"], [\"results\", \"\"], [3, \"ngValue\", \"selected\"]],\n    template: function SearchComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        const _r6 = i0.ɵɵgetCurrentView();\n\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵlistener(\"click\", function SearchComponent_Template_div_click_0_listener() {\n          return ctx.bibleService.displayMenu = false;\n        });\n        i0.ɵɵelementStart(1, \"div\", 1);\n        i0.ɵɵelementStart(2, \"div\", 2);\n        i0.ɵɵelementStart(3, \"label\", 3);\n        i0.ɵɵtext(4, \"Search for:\\u2002\\u00A0\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(5, \"input\", 4, 5);\n        i0.ɵɵlistener(\"keyup.enter\", function SearchComponent_Template_input_keyup_enter_5_listener() {\n          i0.ɵɵrestoreView(_r6);\n\n          const _r0 = i0.ɵɵreference(6);\n\n          return ctx.submitSearch(_r0.value);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(7, \"input\", 6);\n        i0.ɵɵlistener(\"click\", function SearchComponent_Template_input_click_7_listener() {\n          i0.ɵɵrestoreView(_r6);\n\n          const _r0 = i0.ɵɵreference(6);\n\n          return ctx.submitSearch(_r0.value);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(8, \"div\", 7);\n        i0.ɵɵelementStart(9, \"div\", 8);\n        i0.ɵɵelementStart(10, \"label\", 9);\n        i0.ɵɵtext(11, \"Search in:\\u2002\\u00A0\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"select\", 10);\n        i0.ɵɵlistener(\"ngModelChange\", function SearchComponent_Template_select_ngModelChange_12_listener($event) {\n          return ctx.checkedNumber = $event;\n        })(\"ngModelChange\", function SearchComponent_Template_select_ngModelChange_12_listener() {\n          return ctx.selectedTest();\n        });\n        i0.ɵɵtemplate(13, SearchComponent_option_13_Template, 2, 3, \"option\", 11);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"div\");\n        i0.ɵɵelementStart(15, \"label\", 12);\n        i0.ɵɵtext(16, \"Accuracy:\\u2002\\u00A0\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(17, \"select\", 13);\n        i0.ɵɵlistener(\"ngModelChange\", function SearchComponent_Template_select_ngModelChange_17_listener($event) {\n          return ctx.accuracy = $event;\n        })(\"ngModelChange\", function SearchComponent_Template_select_ngModelChange_17_listener() {\n          return ctx.selectedAccuracy();\n        });\n        i0.ɵɵtemplate(18, SearchComponent_option_18_Template, 2, 3, \"option\", 11);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(19, \"hr\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(20, \"br\");\n        i0.ɵɵelement(21, \"div\", 14);\n        i0.ɵɵpipe(22, \"safe\");\n        i0.ɵɵtemplate(23, SearchComponent_ng_template_23_Template, 0, 0, \"ng-template\", 15);\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(5);\n        i0.ɵɵpropertyInterpolate(\"placeholder\", ctx.bibleService.searchRequest);\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"ngModel\", ctx.checkedNumber);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.testaments);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.accuracy);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.accuracyLevel);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"innerHTML\", i0.ɵɵpipeBind2(22, 6, ctx.bibleService.searchResults, \"html\"), i0.ɵɵsanitizeHtml);\n      }\n    },\n    directives: [i4.SelectControlValueAccessor, i4.NgControlStatus, i4.NgModel, i5.NgForOf, i4.NgSelectOption, i4.ɵNgSelectMultipleOption],\n    pipes: [i6.SafePipe],\n    styles: [\"[_ngcontent-%COMP%]:root{--nav: #ccc;--paper: #fff;--gridColor: #eee;--searchHighlight: #ccc;--ink: #000;--zPaper: #bbb;--zInk: #111;--scriptNum: #777;--button: #999;--buttonActive: #ddd;--buttonBorder: #777;--darkRed: #4b0101;--lightRed: #8A0707}html[dataTheme=dark][_ngcontent-%COMP%]{--nav: #444;--paper: #000;--gridColor: #111;--searchHighlight: #333;--ink: #fff;--zPaper: #333;--zInk: #ddd;--button: #777;--scriptNum: #777;--buttonActive: #aaa;--buttonBorder: #333;--darkRed: #4b0101;--lightRed: #8A0707}html[_ngcontent-%COMP%]{scroll-behavior:smooth}body[_ngcontent-%COMP%]{color:var(--ink);background-color:var(--paper);margin:auto;font-size:1.1rem}hr[_ngcontent-%COMP%]{border-color:var(--lightRed)}h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%], h5[_ngcontent-%COMP%]{font-family:Georgia,\\\"Times New Roman\\\",Times,serif;font-weight:normal}.searchSelect[_ngcontent-%COMP%]{background-color:var(--paper);position:sticky;position:-webkit-sticky;top:2.2em;padding-top:.2em;text-align:center}.searchFor[_ngcontent-%COMP%]{border-radius:0;margin:.3rem;white-space:nowrap}.searchInputLabel[_ngcontent-%COMP%]{font-size:1rem;padding:1px;vertical-align:middle}.searchInput[_ngcontent-%COMP%]{max-width:50%;font-size:1.1rem;vertical-align:middle}.searchButton[_ngcontent-%COMP%]{height:1.6rem;width:3rem;vertical-align:middle;background-color:var(--gridColor)}.searchButton[_ngcontent-%COMP%]:hover, .searchButton[_ngcontent-%COMP%]:active{background-color:var(--lightRed)}.searchIn[_ngcontent-%COMP%]{margin:.3rem 0;border-radius:0;font-size:1rem}.searchIn[_ngcontent-%COMP%]   .space[_ngcontent-%COMP%]{margin:.3rem}@media (min-width: 620px){.searchIn[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr}.searchIn[_ngcontent-%COMP%]   .space[_ngcontent-%COMP%]{margin:0}}.testaments[_ngcontent-%COMP%]{font-size:1rem}.accuracy[_ngcontent-%COMP%]{font-size:1rem}.noWrap[_ngcontent-%COMP%]{white-space:nowrap}.searchResults[_ngcontent-%COMP%]{text-align:center;min-height:80vh}  h3{color:red}  .alert{background-color:var(--lightRed);color:#fff;padding:.3em;border:3px solid var(--zPaper)}  .listResults{display:grid;max-width:100%;grid-gap:1rem;grid-template-columns:minmax(min-content,10%) 1fr;padding:0;text-align:left}  .listResults:nth-child(odd){background-color:var(--gridColor)}  .listResults:hover,   .listResults:active{background-color:var(--searchHighlight)}  .bookResults{font-size:.9rem;text-align:right;color:var(--scriptNum);margin:auto 0}  .scrResults{font-size:1.1rem;text-align:left}  .highlight{color:red}\"]\n  });\n  return SearchComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}